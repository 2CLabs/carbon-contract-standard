# 合约标准设计

一 合约设计

标准范围只涉及以上机构的相关合约。暂时不考虑CCER,碳汇,交易所等。暂时不考虑数据的加密.

1 因子库合约从UserAuth合约继承,可以控制只能由部署者或部署者允许的帐号添加/修改因子,而任何帐号可以查看因子.

2 计算公式合约从UserAuth合约继承,可以控制只能由部署者或部署者允许的帐号添加/修改公式,任何帐号可以查看公式.

3 企业碳排数据合约从UserAuth合约继承,可以控制哪些帐号可以添加/修改/查看碳排数据;每个企业对应一个企业碳排数据合约,可以通过IOT设备自动上报碳排数据也可以人工上报碳排数据;碳排数据可以选择加密或不加密;每次碳排数据上报时自动调用Datalayer合约的构造函数自动生成一个DataLayer合约.

4 企业碳排履约合约从UserAuth合约继承,可以控制哪些帐号可以生成/修改/查看碳排报告;每个企业对应一个企业碳排履约合约,月末/年末自动触发生成碳排报告也可以人工触发生成碳排报告;碳排报告可以选择加密或不加密;.每次碳排报告生成时自动调用 Datalayer合约的构造函数自动生成一个DataLayer合约;该合约年初设置配额,年末生成报告进行履约;该合约记录有企业所属行业,以生成碳排报告时获取对应行业的因子库和计算公式进行计算.

5 碳核查合约从UserAuth合约继承,可以控制只能由部署者或部署者允许的帐号添加/修改/查看碳核查流程;该合约控制每年每个企业的碳核查流程.

6 碳配额合约从UserAuth合约继承,可以控制只能由部署者或部署者允许的帐号添加/修改/查看碳配额.该合约年初时由环境厅下发企业配额.

7 所有合约都从Upgradeable合约继承,支持升级.

8 企业自测因子库也放到企业碳排数据合约里,这样支持核查机构检查,也保证了私密性.



二 合约之间的交互

